(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{50:function(e,t,n){e.exports={userPhoto:"users_userPhoto__pOnw3",selectedPage:"users_selectedPage__CpXl2"}},58:function(e,t,n){e.exports={item:"Post_item__2gkFz"}},70:function(e,t,n){},71:function(e,t,n){},75:function(e,t,n){},77:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n(32),c=n(43),r=n(3),i="ADD-POST",o="UPDATE-NEW-POST-TEXT",u="SET_USER_PROFILE",l={posts:[{id:1,message:"Hi, how are you?",likesCount:12},{id:2,message:"It's my first post",likesCount:11},{id:3,message:"Blabla",likesCount:11},{id:4,message:"Dada",likesCount:11}],newPostText:"",profile:null},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i:var n={id:5,message:e.newPostText,likesCount:0};return Object(r.a)(Object(r.a)({},e),{},{posts:[].concat(Object(c.a)(e.posts),[n]),newPostText:""});case o:return Object(r.a)(Object(r.a)({},e),{},{newPostText:t.newText});case u:return Object(r.a)(Object(r.a)({},e),{},{profile:t.profile});default:return e}},d={dialogs:[],messages:[],chat:{},isDialogChose:!1},b=function(e){return{type:"SET_MESSAGES",messages:e}},h=function(e){return{type:"SET_DIALOGS",dialogs:e}},p=function(e){return{type:"SET_CHAT",chat:e}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_MESSAGE":return Object(r.a)({},e);case"SET_MESSAGES":return Object(r.a)(Object(r.a)({},e),{},{newMessageBody:"",messages:t.messages});case"SET_DIALOGS":return Object(r.a)(Object(r.a)({},e),{},{dialogs:t.dialogs});case"SET_CHAT":return Object(r.a)(Object(r.a)({},e),{},{chat:t.chat});case"SET_IS_DIALOG_CHOSEN":return Object(r.a)(Object(r.a)({},e),{},{isDialogChose:!0});default:return e}},g={},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g;return e},m="FOLLOW",x="UNFOLLOW",v="SET_USERS",w="SET_CURRENT_PAGE",_="SET_TOTAL_USERS_COUNT",k="TOGGLE_IS_FETCHING",N="TOGGLE_IS_FOLLOWING_PROGRESS",S={users:[],pageSize:5,totalUsersCount:0,currentPage:1,isFetching:!0,followingInProgress:[]},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(r.a)(Object(r.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(r.a)(Object(r.a)({},e),{},{followed:!0}):e}))});case x:return Object(r.a)(Object(r.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(r.a)(Object(r.a)({},e),{},{followed:!1}):e}))});case v:return Object(r.a)(Object(r.a)({},e),{},{users:t.users});case w:return Object(r.a)(Object(r.a)({},e),{},{currentPage:t.currentPage});case _:return Object(r.a)(Object(r.a)({},e),{},{totalUsersCount:t.count});case k:return Object(r.a)(Object(r.a)({},e),{},{isFetching:t.isFetching});case N:return Object(r.a)(Object(r.a)({},e),{},{followingInProgress:t.isFetching?[].concat(Object(c.a)(e.followingInProgress),[t.userId]):e.followingInProgress.filter((function(e){return e!==t.userId}))});default:return e}},y={token:null,user:{}},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return localStorage.setItem("storageName",JSON.stringify({token:t.jwtSecret,user:t.user})),Object(r.a)(Object(r.a)({},e),{},{token:t.jwtSecret,user:t.user});case"LOGOUT":return localStorage.removeItem("storageName"),Object(r.a)(Object(r.a)({},e),{},{token:null,user:{}});default:return e}},E=Object(a.b)({profilePage:j,dialogsPage:O,sidebar:f,usersPage:P,auth:C}),I=Object(a.c)(E),T=n(0),D=n.n(T),A=n(23),F=n.n(A),G=(n(70),n(71),n(18)),U=n(6),L=n(7),M=(n(75),Object(U.b)((function(e){return{token:e.auth.token}}),(function(e){return{logout:function(){e({type:"LOGOUT"})}}}))((function(e){var t=e.logout,n=Object(L.f)();return Object(s.jsxs)("header",{className:"header",children:[Object(s.jsx)("span",{className:"label",children:Object(s.jsx)("big",{children:"Kalina chats"})}),Object(s.jsxs)("ul",{className:"navigation",children:[Object(s.jsx)("li",{children:Object(s.jsx)(G.b,{to:"/dialogs",children:"Dialogs"})}),Object(s.jsx)("li",{children:Object(s.jsx)(G.b,{to:"/profile/:userId?",children:"Profile"})}),Object(s.jsx)("li",{children:Object(s.jsx)(G.b,{to:"/users",children:"Users"})}),Object(s.jsx)("li",{children:Object(s.jsx)(G.b,{to:"/",onClick:function(e){e.preventDefault(),t(),n.push("/")},children:"Log out"})})]})]})}))),z=(n(77),n(5)),B=n.n(z),R=n(13),H=n(16),q=(n(79),n(107)),J=(n(80),n(112)),W=n(26),X=n.n(W),K=function(){var e=Object(T.useState)(!1),t=Object(H.a)(e,2),n=t[0],s=t[1],a=Object(T.useState)(null),c=Object(H.a)(a,2),r=c[0],i=c[1];return{loading:n,error:r,request:Object(T.useCallback)(function(){var e=Object(R.a)(B.a.mark((function e(t){var n,a,c,r,o,u=arguments;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",a=u.length>2&&void 0!==u[2]?u[2]:null,c=u.length>3&&void 0!==u[3]?u[3]:{},e.prev=3,a&&(a=JSON.stringify(a),c["Content-Type"]="application/json"),e.next=7,fetch("https://kalinaserver.herokuapp.com".concat(t),{method:n,body:a,headers:c});case 7:return r=e.sent,e.next=10,r.json();case 10:if(o=e.sent,r.ok){e.next=13;break}throw new Error(o.message||"Something goes wrong");case 13:return s(!1),e.abrupt("return",o);case 17:throw e.prev=17,e.t0=e.catch(3),s(!1),i(e.t0.message),e.t0;case 22:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}(),[]),clearError:Object(T.useCallback)((function(){return i(null)}),[])}},Q=new X.a("b634efb073fba40fbf3a",{cluster:"eu"}),V=Object(U.b)((function(e){return{dialogs:e.dialogsPage.dialogs,token:e.auth.token}}),(function(e){return{setDialogs:function(t){e(h(t))},setMessages:function(t){e(b(t))},setChat:function(t){e(p(t))},setIsDialogChose:function(){e({type:"SET_IS_DIALOG_CHOSEN"})}}}))((function(e){var t=K(),n=(t.loading,t.error,t.request),a=(t.clearError,Object(T.useState)({})),c=Object(H.a)(a,2),r=c[0],i=c[1],o="",u="",l=0,j=function(){var t=Object(R.a)(B.a.mark((function t(){var s;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/lastMessage?id=".concat(e.id),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,i(s),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(1);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();Object(T.useEffect)((function(){j();var e=Q.subscribe("messages");return e.bind("newMessage",(function(){j()})),function(){e.unbind_all(),e.unsubscribe()}}),[e.id]);var d=function(){var t=Object(R.a)(B.a.mark((function t(){var s;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/conversation?id=".concat(e.id),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,e.setMessages(s[0].conversation),e.setChat({chatName:s[0].chatName,chatId:e.id}),e.setIsDialogChose(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(1);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();try{o=r.user.displayName,u=r.message,l=r.timestamp}catch(b){}return Object(s.jsxs)("div",{onClick:function(){return d()},className:"dialogItem",children:[Object(s.jsxs)("div",{className:"dialogItem__info",children:[Object(s.jsx)(J.a,{}),Object(s.jsx)("h2",{children:e.name}),Object(s.jsx)("p",{children:o+": "+u||""})]}),Object(s.jsx)("small",{children:new Date(parseInt(l)).toISOString().replace(/T/g," ").replace(/\..*/,"")})]})})),Y=n(106),Z=new X.a("b634efb073fba40fbf3a",{cluster:"eu"}),$=Object(U.b)((function(e){return{dialogs:e.dialogsPage.dialogs,user:e.auth.user,token:e.auth.token}}),(function(e){return{setDialogs:function(t){e(h(t))}}}))((function(e){var t=K(),n=(t.error,t.request),a=(t.clearError,Object(T.useState)(!1)),c=Object(H.a)(a,2),r=(c[0],c[1],function(){var t=Object(R.a)(B.a.mark((function t(){var s;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/conversations","GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,e.setDialogs(s),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(1);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}());Object(T.useEffect)((function(){r(),Z.subscribe("chats").bind("newChat",(function(){r()}))}),[]);var i=function(){var t=Object(R.a)(B.a.mark((function t(s){var a,c,r,i;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),a=prompt("Enter a chat name"),c=prompt("Send a welcome message"),!a||!c){t.next=17;break}return t.prev=4,r="",t.next=8,n("/api/chats/new/conversation","POST",{chatName:a},{Authorization:"Bearer ".concat(e.token)});case 8:return i=t.sent,r=i._id,t.next=12,n("/api/chats/new/message?id=".concat(r),"POST",{message:c,timestamp:Date.now(),user:e.user},{Authorization:"Bearer ".concat(e.token)});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),console.log(1);case 17:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"dialogs",children:[Object(s.jsx)("div",{className:"dialogs__header",children:Object(s.jsx)(Y.a,{onClick:i,children:"Add a new chat"})}),Object(s.jsx)("div",{className:"dialogs__search",children:Object(s.jsxs)("div",{className:"dialogs__searchContainer",children:[Object(s.jsx)(q.a,{}),Object(s.jsx)("input",{placeholder:"Search or start new chat",type:"text"})]})}),Object(s.jsx)("div",{className:"dialogs__items",children:e.dialogs.map((function(e){return Object(s.jsx)(V,{name:e.name,id:e.id,timestamp:e.timestamp},e.id)}))})]})})),ee=n(108),te=n(109),ne=n(110),se=n(111),ae=n(57),ce=n.n(ae),re=(n(81),n(82),function(e){return Object(s.jsxs)("div",{className:"messages__item  ".concat(e.message.user.displayName===e.userName&&"messages__receiver"),children:[Object(s.jsx)("span",{className:"message__name",children:e.message.user.displayName}),Object(s.jsx)("div",{className:"message",children:e.message.message}),Object(s.jsx)("span",{className:"message__timestamp",children:new Date(parseInt(e.message.timestamp)).toISOString().replace(/T/g," ").replace(/\..*/,"")})]})}),ie=function(e){var t=K(),n=(t.loading,t.error,t.request),a=(t.clearError,Object(T.useState)("")),c=Object(H.a)(a,2),r=c[0],i=c[1],o=function(){var t=Object(R.a)(B.a.mark((function t(s){return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.preventDefault(),t.prev=1,t.next=4,n("/api/chats/new/message?id=".concat(e.chat.chatId),"POST",{message:r,timestamp:Date.now(),user:e.user},{Authorization:"Bearer ".concat(e.token)});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log(1);case 9:i("");case 10:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}(),u=function(){var e=document.querySelector(".messages__body");e.scrollTop=e.scrollHeight};return Object(T.useEffect)((function(){var t=new X.a("b634efb073fba40fbf3a",{cluster:"eu"}).subscribe("messages");return t.bind("newMessage",Object(R.a)(B.a.mark((function t(){var s;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/conversation?id=".concat(e.chat.chatId),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,e.setMessages(s[0].conversation),u(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(1);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))),u(),function(){t.unbind_all(),t.unsubscribe()}}),[e.chat.chatId]),Object(s.jsxs)("div",{className:"messages",children:[Object(s.jsxs)("div",{className:"messages__header",children:[Object(s.jsx)(J.a,{}),Object(s.jsxs)("div",{className:"messages__headerInfo",children:[Object(s.jsx)("h3",{children:e.chat.chatName}),Object(s.jsx)("p",{children:"Last seen at..."})]}),Object(s.jsxs)("div",{className:"messages__headerRight",children:[Object(s.jsx)(ee.a,{children:Object(s.jsx)(q.a,{})}),Object(s.jsx)(ee.a,{children:Object(s.jsx)(te.a,{})}),Object(s.jsx)(ee.a,{children:Object(s.jsx)(ne.a,{})})]})]}),Object(s.jsx)("div",{className:"messages__body",children:e.messages.map((function(t){return Object(s.jsx)(re,{userName:e.user.displayName,message:t},t._id)}))}),Object(s.jsxs)("div",{className:"messages__footer",children:[Object(s.jsx)(se.a,{}),Object(s.jsxs)("form",{children:[Object(s.jsx)("input",{type:"text",value:r,onChange:function(e){var t=e.target.value;i(t)},placeholder:"Enter your message"}),Object(s.jsx)("button",{type:"submit",onClick:o,children:"Send"})]}),Object(s.jsx)(ce.a,{})]})]})},oe=Object(U.b)((function(e){return{messages:e.dialogsPage.messages,chat:e.dialogsPage.chat,user:e.auth.user,token:e.auth.token}}),(function(e){return{sendMessage:function(){e({type:"SEND_MESSAGE"})},setMessages:function(t){e(b(t))},setChat:function(t){e(p(t))}}}))(ie),ue=Object(U.b)((function(e){return{isDialogChose:e.dialogsPage.isDialogChose}}))((function(e){return Object(s.jsxs)("div",{className:"main",children:[Object(s.jsx)($,{}),e.isDialogChose?Object(s.jsx)(oe,{}):Object(s.jsx)("div",{className:"chooseChat",children:"Choose a chat"})]})})),le=n(40),je=n(41),de=n(44),be=n(42),he=(n(87),function(e){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{children:Object(s.jsx)("img",{alt:"",src:"https://images.pexels.com/photos/248797/pexels-photo-248797.jpeg?auto=compress&cs=tinysrgb&h=350"})}),Object(s.jsxs)("div",{className:"description",children:[Object(s.jsx)("img",{alt:"",src:e.profile.photos.large}),"ava + description"]})]})}),pe=(n(88),n(58)),Oe=n.n(pe),ge=function(e){return Object(s.jsxs)("div",{className:Oe.a.item,children:[Object(s.jsx)("img",{alt:"",src:"https://movies4maniacs.liberty.me/wp-content/uploads/sites/1218/2015/09/avatarsucks.jpg"}),e.message,Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{children:"like"})," ",e.likesCount]})]})},fe=function(e){var t=e.posts.map((function(e){return Object(s.jsx)(ge,{message:e.message,likesCount:e.likesCount})})),n=D.a.createRef();return Object(s.jsxs)("div",{className:"posts",children:[Object(s.jsx)("h3",{children:"My posts"}),Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{children:Object(s.jsx)("textarea",{onChange:function(){var t=n.current.value;e.updateNewPostText(t)},ref:n,value:e.newPostText})}),Object(s.jsx)("div",{children:Object(s.jsx)("button",{onClick:function(){e.addPost()},children:"Add post"})})]}),Object(s.jsx)("div",{className:"posts__list",children:t})]})},me=Object(U.b)((function(e){return{posts:e.profilePage.posts,newPostText:e.profilePage.newPostText}}),(function(e){return{updateNewPostText:function(t){var n=function(e){return{type:o,newText:e}}(t);e(n)},addPost:function(){e({type:i})}}}))(fe),xe=(n(89),function(e){return Object(s.jsx)("div",{className:"profile",children:Object(s.jsxs)("div",{className:"profile__inner",children:[Object(s.jsx)(he,{profile:e.profile}),Object(s.jsx)(me,{})]})})}),ve=function(e){Object(de.a)(n,e);var t=Object(be.a)(n);function n(){return Object(le.a)(this,n),t.apply(this,arguments)}return Object(je.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.userId;e||(e=2)}},{key:"render",value:function(){return Object(s.jsx)(xe,Object(r.a)(Object(r.a)({},this.props),{},{profile:this.props.profile}))}}]),n}(D.a.Component),we=Object(L.g)(ve),_e=Object(U.b)((function(e){return{profile:e.profilePage.profile}}),{setUserProfile:function(e){return{type:u,profile:e}}})(we),ke=n(50),Ne=n.n(ke),Se=n.p+"static/media/user.96e310a6.png",Pe=function(e){for(var t=Math.ceil(e.totalUsersCount/e.pageSize),n=[],a=1;a<=t;a++)n.push(a);return Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{children:n.map((function(t){return Object(s.jsx)("span",{className:e.currentPage===t&&Ne.a.selectedPage,onClick:function(n){e.onPageChanged(t)},children:t})}))}),e.users.map((function(t){return Object(s.jsxs)("div",{children:[Object(s.jsxs)("span",{children:[Object(s.jsx)("div",{children:Object(s.jsx)(G.c,{to:"/profile/"+t.id,children:Object(s.jsx)("img",{alt:"",src:null!=t.photos.small?t.photos.small:Se,className:Ne.a.userPhoto})})}),Object(s.jsx)("div",{children:t.followed?Object(s.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.toggleFollowingProgress(!0,t.id)},children:"Unfollow"}):Object(s.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.toggleFollowingProgress(!0,t.id)},children:"Follow"})})]}),Object(s.jsxs)("span",{children:[Object(s.jsxs)("span",{children:[Object(s.jsx)("div",{children:t.name}),Object(s.jsx)("div",{children:t.status})]}),Object(s.jsxs)("span",{children:[Object(s.jsx)("div",{children:"u.location.country"}),Object(s.jsx)("div",{children:"u.location.city"})]})]})]},t.id)}))]})},ye=function(e){Object(de.a)(n,e);var t=Object(be.a)(n);function n(){var e;Object(le.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).onPageChanged=function(t){e.props.setCurrentPage(t),e.props.toggleIsFetching(!0)},e}return Object(je.a)(n,[{key:"componentDidMount",value:function(){this.props.toggleIsFetching(!0)}},{key:"render",value:function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(Pe,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,onPageChanged:this.onPageChanged,users:this.props.users,follow:this.props.follow,unfollow:this.props.unfollow,toggleFollowingProgress:this.props.toggleFollowingProgress,followingInProgress:this.props.followingInProgress})})}}]),n}(D.a.Component),Ce=Object(U.b)((function(e){return{users:e.usersPage.users,pageSize:e.usersPage.pageSize,totalUsersCount:e.usersPage.totalUsersCount,currentPage:e.usersPage.currentPage,isFetching:e.usersPage.isFetching,followingInProgress:e.usersPage.followingInProgress}}),{follow:function(e){return{type:m,userId:e}},unfollow:function(e){return{type:x,userId:e}},setUsers:function(e){return{type:v,users:e}},setCurrentPage:function(e){return{type:w,currentPage:e}},setTotalUsersCount:function(e){return{type:_,count:e}},toggleIsFetching:function(e){return{type:k,isFetching:e}},toggleFollowingProgress:function(e,t){return{type:N,isFetching:e,userId:t}}})(ye),Ee=n(38),Ie=(n(90),function(){return Object(s.jsx)("div",{className:"wrapper",children:Object(s.jsxs)("div",{className:"ldio-xb2vocd1fhk",children:[Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})}),Object(s.jsx)("div",{children:Object(s.jsx)("div",{})})]})})}),Te=(n(91),Object(U.b)((function(e){return{token:e.auth.token}}),(function(e){return{login:function(t,n){e(function(e,t){return{type:"LOGIN",jwtSecret:e,user:t}}(t,n))}}}))((function(e){var t=e.login,n=Object(T.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[]),a=K(),c=a.error,i=a.request,o=a.clearError,u=Object(T.useState)(!1),l=Object(H.a)(u,2),j=l[0],d=l[1],b=Object(T.useState)({email:"",displayName:"",password:""}),h=Object(H.a)(b,2),p=h[0],O=h[1],g=Object(T.useState)(!1),f=Object(H.a)(g,2),m=f[0],x=f[1];Object(T.useEffect)((function(){n(c),o()}),[c,n,o]),Object(T.useEffect)((function(){var e=JSON.parse(localStorage.getItem("storageName"));e&&e.token&&t(e.token,e.user)}),[]);var v=function(e){O(Object(r.a)(Object(r.a)({},p),{},Object(Ee.a)({},e.target.name,e.target.value)))},w=function(){var t=Object(R.a)(B.a.mark((function t(){var s;return B.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,d(!0),t.next=4,i("/api/auth/register","POST",Object(r.a)({},p),{Authorization:"Bearer ".concat(e.token)});case 4:s=t.sent,n(s.message),d(!1),k(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(-1);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),_=function(){var n=Object(R.a)(B.a.mark((function n(){var s;return B.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,d(!0),n.next=4,i("/api/auth/login","POST",Object(r.a)({},p),{Authorization:"Bearer ".concat(e.token)});case 4:s=n.sent,t(s.token,s.user),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(-1);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}(),k=function(){x(!m)};return Object(s.jsx)(s.Fragment,{children:j?Object(s.jsx)(Ie,{}):Object(s.jsx)("div",{className:"auth-form",children:Object(s.jsxs)("div",{className:"auth-form__inner",children:[Object(s.jsx)("h1",{children:"Sign In With"}),Object(s.jsxs)("div",{className:"auth-form__main",children:[Object(s.jsxs)("div",{className:"auth-form__fields",children:[Object(s.jsx)("div",{className:"auth-form__email",children:Object(s.jsx)("input",{name:"email",id:"email",type:"email",className:"validate",value:p.email,onChange:v,placeholder:"Email"})}),m&&Object(s.jsx)("div",{className:"auth-form__name",children:Object(s.jsx)("input",{name:"displayName",id:"displayName",type:"text",className:"validate",value:p.displayName,onChange:v,placeholder:"Name"})}),Object(s.jsx)("div",{className:"auth-form__password",children:Object(s.jsx)("input",{name:"password",id:"password",type:"password",className:"validate",value:p.password,onChange:v,placeholder:"Password"})})]}),Object(s.jsxs)("div",{className:"auth-form__btn",children:[m?Object(s.jsx)("button",{onClick:w,children:"Sign up"}):Object(s.jsx)("button",{onClick:_,children:"Sign in"}),m?Object(s.jsx)("a",{onClick:k,children:"\u2190Back"}):Object(s.jsxs)("div",{children:[Object(s.jsx)("p",{children:"or"}),Object(s.jsxs)("p",{children:["Not a member? ",Object(s.jsx)("a",{onClick:k,children:"Sign up"})," now!"]})]})]})]})]})})})}))),De=Object(U.b)((function(e){return{token:e.auth.token}}))((function(e){var t=!!e.token,n=t?Object(s.jsxs)(L.c,{children:[Object(s.jsx)(L.a,{exact:!0,path:"/dialogs",component:ue}),Object(s.jsx)(L.a,{exact:!0,path:"/profile/:userId?",render:function(){return Object(s.jsx)(_e,{})}}),Object(s.jsx)(L.a,{exact:!0,path:"/users",render:function(){return Object(s.jsx)(Ce,{})}})]}):Object(s.jsx)(L.a,{path:"/",exact:!0,component:Te});return Object(s.jsx)(G.a,{children:Object(s.jsxs)("div",{className:"root__child",children:[t&&Object(s.jsx)(M,{}),Object(s.jsx)("div",{className:"app-wrapper",children:Object(s.jsx)("div",{className:"app-wrapper-content",children:n})})]})})}));F.a.render(Object(s.jsx)(U.a,{store:I,children:Object(s.jsx)(De,{})}),document.getElementById("root"))}},[[92,1,2]]]);
//# sourceMappingURL=main.b77ff215.chunk.js.map