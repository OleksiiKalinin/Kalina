(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{47:function(e,t,n){e.exports={userPhoto:"users_userPhoto__3Itvp",selectedPage:"users_selectedPage__2hka0"}},68:function(e,t,n){},69:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t);var s=n(1),c=n(31),r=n(41),a=n(3),i="ADD-POST",o="UPDATE-NEW-POST-TEXT",u="SET_USER_PROFILE",l={posts:[{id:1,message:"Hi, how are you?",likesCount:12},{id:2,message:"It's my first post",likesCount:11},{id:3,message:"Blabla",likesCount:11},{id:4,message:"Dada",likesCount:11}],newPostText:"",profile:null},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i:var n={id:5,message:e.newPostText,likesCount:0};return Object(a.a)(Object(a.a)({},e),{},{posts:[].concat(Object(r.a)(e.posts),[n]),newPostText:""});case o:return Object(a.a)(Object(a.a)({},e),{},{newPostText:t.newText});case u:return Object(a.a)(Object(a.a)({},e),{},{profile:t.profile});default:return e}},d={dialogs:[],messages:[],chat:{},isDialogSelected:!1},b=function(e){return{type:"SET_MESSAGES",messages:e}},h=function(e){return{type:"SET_DIALOGS",dialogs:e}},p=function(e){return{type:"SET_CHAT",chat:e}},O=function(e){return{type:"SET_IS_DIALOG_SELECTED",isDialogSelected:e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_MESSAGE":return Object(a.a)({},e);case"SET_MESSAGES":return Object(a.a)(Object(a.a)({},e),{},{newMessageBody:"",messages:t.messages});case"SET_DIALOGS":return Object(a.a)(Object(a.a)({},e),{},{dialogs:t.dialogs});case"SET_CHAT":return Object(a.a)(Object(a.a)({},e),{},{chat:t.chat});case"SET_IS_DIALOG_SELECTED":return Object(a.a)(Object(a.a)({},e),{},{isDialogSelected:t.isDialogSelected});default:return e}},g={},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g;return e},x="FOLLOW",v="UNFOLLOW",w="SET_USERS",k="SET_CURRENT_PAGE",y="SET_TOTAL_USERS_COUNT",S="TOGGLE_IS_FETCHING",N="TOGGLE_IS_FOLLOWING_PROGRESS",_={users:[],pageSize:5,totalUsersCount:0,currentPage:1,isFetching:!0,followingInProgress:[]},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(a.a)(Object(a.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(a.a)(Object(a.a)({},e),{},{followed:!0}):e}))});case v:return Object(a.a)(Object(a.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(a.a)(Object(a.a)({},e),{},{followed:!1}):e}))});case w:return Object(a.a)(Object(a.a)({},e),{},{users:t.users});case k:return Object(a.a)(Object(a.a)({},e),{},{currentPage:t.currentPage});case y:return Object(a.a)(Object(a.a)({},e),{},{totalUsersCount:t.count});case S:return Object(a.a)(Object(a.a)({},e),{},{isFetching:t.isFetching});case N:return Object(a.a)(Object(a.a)({},e),{},{followingInProgress:t.isFetching?[].concat(Object(r.a)(e.followingInProgress),[t.userId]):e.followingInProgress.filter((function(e){return e!==t.userId}))});default:return e}},P={token:null,user:{}},C=function(e,t){return{type:"LOGIN",jwtSecret:e,user:t}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return sessionStorage.setItem("storageName",JSON.stringify({token:t.jwtSecret,user:t.user})),Object(a.a)(Object(a.a)({},e),{},{token:t.jwtSecret,user:t.user});case"LOGOUT":return sessionStorage.removeItem("storageName"),Object(a.a)(Object(a.a)({},e),{},{token:null,user:{}});default:return e}},T=Object(c.b)({profilePage:j,dialogsPage:f,sidebar:m,usersPage:E,auth:I}),D=Object(c.c)(T),A=n(0),z=n.n(A),L=n(20),F=n.n(L),G=(n(68),n(69),n(14)),M=n(9),U=n(7),R=(n(73),Object(U.b)((function(e){return{token:e.auth.token}}),(function(e){return{logout:function(){e({type:"LOGOUT"})}}}))((function(e){var t=e.logout,n=Object(M.f)();return Object(s.jsxs)("header",{className:"header",children:[Object(s.jsx)("span",{className:"label",children:Object(s.jsx)(G.b,{to:"/",children:Object(s.jsx)("big",{children:"Kalina"})})}),Object(s.jsxs)("div",{className:"navigation",children:[Object(s.jsx)(G.b,{to:"/",children:"Home"}),Object(s.jsx)(G.b,{to:"/profile",children:"Profile"}),Object(s.jsx)(G.b,{to:"/dialogs",children:"Dialogs"}),Object(s.jsx)(G.b,{to:"/users",children:"Users"}),Object(s.jsx)(G.b,{to:"/",onClick:function(e){e.preventDefault(),t(),n.push("/")},children:"Log out"})]})]})}))),B=(n(75),n(4)),J=n.n(B),W=n(8),q=n(5),H=(n(77),n(78),n(25)),X=n.n(H),Y=function(){var e=Object(A.useState)(!1),t=Object(q.a)(e,2),n=t[0],s=t[1],c=Object(A.useState)(null),r=Object(q.a)(c,2),a=r[0],i=r[1];return{loading:n,error:a,request:Object(A.useCallback)(function(){var e=Object(W.a)(J.a.mark((function e(t){var n,c,r,a,o,u=arguments;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",c=u.length>2&&void 0!==u[2]?u[2]:null,r=u.length>3&&void 0!==u[3]?u[3]:{},e.prev=3,c&&(c=JSON.stringify(c),r["Content-Type"]="application/json"),e.next=7,fetch("https://kalinaserver.herokuapp.com".concat(t),{method:n,body:c,headers:r});case 7:return a=e.sent,e.next=10,a.json();case 10:if(o=e.sent,a.ok){e.next=13;break}throw new Error(o.message||"Something goes wrong");case 13:return s(!1),e.abrupt("return",o);case 17:throw e.prev=17,e.t0=e.catch(3),s(!1),i(e.t0.message),e.t0;case 22:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}(),[]),clearError:Object(A.useCallback)((function(){return i(null)}),[])}},Z=n.p+"static/media/user.96e310a6.png",V=new X.a("b634efb073fba40fbf3a",{cluster:"eu"}),Q=Object(U.b)((function(e){return{dialogs:e.dialogsPage.dialogs,token:e.auth.token}}),(function(e){return{setDialogs:function(t){e(h(t))},setMessages:function(t){e(b(t))},setChat:function(t){e(p(t))},setIsDialogSelected:function(t){e(O(t))}}}))((function(e){var t=Y(),n=(t.loading,t.error,t.request),c=(t.clearError,Object(A.useState)({})),r=Object(q.a)(c,2),a=r[0],i=r[1],o="",u="",l=function(){var t=Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/lastMessage?id=".concat(e.id),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,i(s),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(1);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();Object(A.useEffect)((function(){l();var e=V.subscribe("messages");return e.bind("newMessage",(function(){l()})),function(){e.unbind_all(),e.unsubscribe()}}),[e.id]);var j=function(){var t=Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/conversation?id=".concat(e.id),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,e.setMessages(s[0].conversation),e.setChat({chatName:s[0].chatName,chatId:e.id}),e.setIsDialogSelected(!0),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(1);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}}();try{o=a.user.displayName,u=a.message,a.timestamp}catch(d){}return Object(s.jsx)("div",{onClick:j,className:"dialogItem",children:Object(s.jsxs)("div",{className:"dialogItem__info",children:[Object(s.jsx)("div",{className:"dialogItem__info-avatar",children:Object(s.jsx)("img",{src:Z,alt:""})}),Object(s.jsxs)("div",{className:"dialogItem__info-main",children:[Object(s.jsx)("div",{children:Object(s.jsx)("h1",{children:e.name})}),Object(s.jsxs)("span",{className:"dialogItem__info-message",children:[o,": ",u]})]}),Object(s.jsx)("div",{className:"timaStamp",children:Object(s.jsx)("small",{children:"24.03"})})]})})})),K=new X.a("b634efb073fba40fbf3a",{cluster:"eu"}),$=Object(U.b)((function(e){return{dialogs:e.dialogsPage.dialogs,isDialogSelected:e.dialogsPage.isDialogSelected,user:e.auth.user,token:e.auth.token}}),(function(e){return{setDialogs:function(t){e(h(t))}}}))((function(e){var t=Y(),n=(t.error,t.request),c=(t.clearError,Object(A.useState)(!1)),r=Object(q.a)(c,2),a=(r[0],r[1],Object(A.useRef)(null)),i=Object(A.useRef)(null),o=Object(A.useRef)(null),u=function(){var t=Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/conversations","GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,e.setDialogs(s),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();Object(A.useEffect)((function(){e.isDialogSelected?a.current.classList.remove("show"):a.current.classList.add("show")}),[e.isDialogSelected]),Object(A.useEffect)((function(){u(),K.subscribe("chats").bind("newChat",(function(){u()}))}),[]);var l=function(){var t=Object(W.a)(J.a.mark((function t(s){var c,r,a,i;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),c=prompt("Enter a chat name"),r=prompt("Send a welcome message"),!c||!r){t.next=17;break}return t.prev=4,a="",t.next=8,n("/api/chats/new/conversation","POST",{chatName:c},{Authorization:"Bearer ".concat(e.token)});case 8:return i=t.sent,a=i._id,t.next=12,n("/api/chats/new/message?id=".concat(a),"POST",{message:r,timestamp:Date.now(),user:e.user},{Authorization:"Bearer ".concat(e.token)});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),console.log(1);case 17:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}();return Object(s.jsxs)("div",{ref:a,className:"dialogs",children:[Object(s.jsxs)("div",{ref:i,className:"dialogs__header",children:[Object(s.jsx)("input",{placeholder:"Search or start new chat",type:"text"}),Object(s.jsx)("button",{onClick:l,children:"+"})]}),Object(s.jsx)("div",{ref:o,className:"dialogs__items",children:e.dialogs.map((function(e){return Object(s.jsx)(Q,{name:e.name,id:e.id,timestamp:e.timestamp},e.id)}))})]})})),ee=n(110),te=n(109),ne=n(105),se=n(106),ce=n(107),re=n(108),ae=n(54),ie=n.n(ae),oe=(n(79),n(80),function(e){return Object(s.jsxs)("div",{className:"messages__item  ".concat(e.message.user.displayName===e.userName&&"messages__receiver"),children:[Object(s.jsx)("span",{className:"message__name",children:e.message.user.displayName}),Object(s.jsx)("div",{className:"message",children:e.message.message}),Object(s.jsx)("span",{className:"message__timestamp",children:new Date(parseInt(e.message.timestamp)).toISOString().replace(/T/g," ").replace(/\..*/,"")})]})}),ue=(n.p,function(e){var t=Y(),n=(t.loading,t.error,t.request),c=(t.clearError,Object(A.useState)("")),r=Object(q.a)(c,2),a=r[0],i=r[1],o=function(){var t=Object(W.a)(J.a.mark((function t(s){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.preventDefault(),t.prev=1,t.next=4,n("/api/chats/new/message?id=".concat(e.chat.chatId),"POST",{message:a,timestamp:Date.now(),user:e.user},{Authorization:"Bearer ".concat(e.token)});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.log(1);case 9:i("");case 10:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}(),u=function(){try{var e=document.querySelector(".messages__body");e.scrollTop=e.scrollHeight}catch(t){}};Object(A.useEffect)((function(){return window.addEventListener("resize",(function(){return u()})),function(){return window.removeEventListener("resize",(function(){return u()}))}}),[]),Object(A.useEffect)((function(){var t=new X.a("b634efb073fba40fbf3a",{cluster:"eu"}).subscribe("messages");return t.bind("newMessage",Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/chats/get/conversation?id=".concat(e.chat.chatId),"GET",null,{Authorization:"Bearer ".concat(e.token)});case 3:s=t.sent,e.setMessages(s[0].conversation),u(),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})))),u(),function(){t.unbind_all(),t.unsubscribe()}}),[e.chat.chatId]);return Object(s.jsxs)("div",{className:"messages",children:[Object(s.jsxs)("div",{className:"messages__header",children:[Object(s.jsx)("i",{onClick:function(){e.setIsDialogSelected(!1)},className:"material-icons btnBack",style:{fontSize:"40px"},children:"arrow_back"}),Object(s.jsx)(ee.a,{}),Object(s.jsx)("div",{className:"messages__headerInfo",children:Object(s.jsx)("h3",{children:e.chat.chatName})}),Object(s.jsxs)("div",{className:"messages__headerRight",children:[Object(s.jsx)(te.a,{children:Object(s.jsx)(ne.a,{})}),Object(s.jsx)(te.a,{children:Object(s.jsx)(se.a,{})}),Object(s.jsx)(te.a,{children:Object(s.jsx)(ce.a,{})})]})]}),Object(s.jsx)("div",{className:"messages__body",children:e.messages.map((function(t){return Object(s.jsx)(oe,{userName:e.user.displayName,message:t},t._id)}))}),Object(s.jsxs)("div",{className:"messages__footer",children:[Object(s.jsx)(re.a,{className:"emoji"}),Object(s.jsxs)("form",{children:[Object(s.jsx)("input",{type:"text",value:a,onChange:function(e){var t=e.target.value;i(t)},placeholder:"Enter your message"}),Object(s.jsx)("button",{type:"submit",onClick:o,children:"Send"})]}),Object(s.jsx)(ie.a,{})]})]})}),le=Object(U.b)((function(e){return{messages:e.dialogsPage.messages,chat:e.dialogsPage.chat,user:e.auth.user,token:e.auth.token}}),(function(e){return{sendMessage:function(){e({type:"SEND_MESSAGE"})},setMessages:function(t){e(b(t))},setChat:function(t){e(p(t))},setIsDialogSelected:function(t){e(O(t))}}}))(ue),je=Object(U.b)((function(e){return{isDialogSelected:e.dialogsPage.isDialogSelected}}))((function(e){return Object(s.jsxs)("div",{className:"dialogs-page",children:[Object(s.jsx)($,{}),e.isDialogSelected?Object(s.jsx)(le,{}):Object(s.jsx)("div",{className:"chooseChat",children:"Choose a chat"})]})})),de=(n(85),Object(U.b)((function(e){return{token:e.auth.token,user:e.auth.user}}))((function(e){var t=Y(),n=(t.error,t.request),c=(t.clearError,Object(A.useState)(!1)),r=Object(q.a)(c,2),a=r[0],i=r[1],o=Object(A.useState)(""),u=Object(q.a)(o,2),l=u[0],j=u[1],d=Object(A.useState)(""),b=Object(q.a)(d,2),h=b[0],p=b[1],O=Object(A.useState)(""),f=Object(q.a)(O,2),g=f[0],m=f[1],x=Object(A.useState)([]),v=Object(q.a)(x,2),w=v[0],k=v[1];Object(A.useEffect)(Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("/api/posts/get/myposts","GET",null,{Authorization:"Bearer ".concat(e.token)});case 2:s=t.sent,k(s.posts);case 4:case"end":return t.stop()}}),t)}))),[]);var y=function(){var t=Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=new FormData).append("file",g),s.append("upload_preset","kalina-why-not"),s.append("cloud_name","kalina-why-not"),t.next=6,fetch("https://api.cloudinary.com/v1_1/kalina-why-not/image/upload",{method:"POST",body:s}).then((function(e){return e.json()})).then(function(){var t=Object(W.a)(J.a.mark((function t(s){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("/api/posts/new/post","POST",{title:l,body:h,picture:s.url},{Authorization:"Bearer ".concat(e.token)});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){return console.log(e)}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(s.jsxs)("div",{className:"profile-page",children:[Object(s.jsxs)("div",{className:"profile__info",children:[Object(s.jsx)("div",{children:Object(s.jsx)("img",{src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/5952bfa6-4594-4d7c-bee6-0b5a3988a099/dapn32z-2a11b870-38b2-4caf-ba16-5bbe9a84fe7f.png/v1/fill/w_200,h_200,strp/moonlight_deer___200x200_pixelart_by_fluffzee_dapn32z-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOiIsImlzcyI6InVybjphcHA6Iiwib2JqIjpbW3siaGVpZ2h0IjoiPD0yMDAiLCJwYXRoIjoiXC9mXC81OTUyYmZhNi00NTk0LTRkN2MtYmVlNi0wYjVhMzk4OGEwOTlcL2RhcG4zMnotMmExMWI4NzAtMzhiMi00Y2FmLWJhMTYtNWJiZTlhODRmZTdmLnBuZyIsIndpZHRoIjoiPD0yMDAifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.nf-qh5IpeWu7UCzndssg2ee6_hETzDEAjAQ8cmU0JXE",alt:""})}),Object(s.jsxs)("div",{children:[Object(s.jsx)("h4",{children:e.user.displayName}),Object(s.jsxs)("div",{className:"profile__info-attributes",children:[Object(s.jsx)("h5",{children:"40 posts"}),Object(s.jsx)("h5",{children:"30 followers"}),Object(s.jsx)("h5",{children:"40 following"})]})]})]}),Object(s.jsx)("button",{onClick:function(){return i(!0)},children:"Add new post"}),a&&Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"newPostWindow",children:[Object(s.jsx)("div",{className:"closeWindow",onClick:function(){return i(!1)},children:"Close"}),Object(s.jsxs)("div",{className:"newPostBody",children:[Object(s.jsx)("span",{children:"Title"}),Object(s.jsx)("input",{type:"text",placeholder:"Enter title",value:l,onChange:function(e){return j(e.target.value)}}),Object(s.jsx)("span",{children:"Description"}),Object(s.jsx)("input",{type:"text",placeholder:"Enter Description",value:h,onChange:function(e){return p(e.target.value)}}),Object(s.jsx)("span",{children:"Upload image"}),Object(s.jsx)("input",{type:"file",onChange:function(e){return m(e.target.files[0])}}),Object(s.jsx)("button",{onClick:y,children:"Submit"})]})]})}),Object(s.jsx)("div",{className:"profile__gallery",children:w.map((function(e){return Object(s.jsx)("img",{src:e.picture,alt:""},e._id)}))})]})}))),be=n(55),he=n(56),pe=n(58),Oe=n(57),fe=n(47),ge=n.n(fe),me=function(e){for(var t=Math.ceil(e.totalUsersCount/e.pageSize),n=[],c=1;c<=t;c++)n.push(c);return Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{children:n.map((function(t){return Object(s.jsx)("span",{className:e.currentPage===t&&ge.a.selectedPage,onClick:function(n){e.onPageChanged(t)},children:t})}))}),e.users.map((function(t){return Object(s.jsxs)("div",{children:[Object(s.jsxs)("span",{children:[Object(s.jsx)("div",{children:Object(s.jsx)(G.c,{to:"/profile/"+t.id,children:Object(s.jsx)("img",{alt:"",src:null!=t.photos.small?t.photos.small:Z,className:ge.a.userPhoto})})}),Object(s.jsx)("div",{children:t.followed?Object(s.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.toggleFollowingProgress(!0,t.id)},children:"Unfollow"}):Object(s.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.toggleFollowingProgress(!0,t.id)},children:"Follow"})})]}),Object(s.jsxs)("span",{children:[Object(s.jsxs)("span",{children:[Object(s.jsx)("div",{children:t.name}),Object(s.jsx)("div",{children:t.status})]}),Object(s.jsxs)("span",{children:[Object(s.jsx)("div",{children:"u.location.country"}),Object(s.jsx)("div",{children:"u.location.city"})]})]})]},t.id)}))]})},xe=function(e){Object(pe.a)(n,e);var t=Object(Oe.a)(n);function n(){var e;Object(be.a)(this,n);for(var s=arguments.length,c=new Array(s),r=0;r<s;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).onPageChanged=function(t){e.props.setCurrentPage(t),e.props.toggleIsFetching(!0)},e}return Object(he.a)(n,[{key:"componentDidMount",value:function(){this.props.toggleIsFetching(!0)}},{key:"render",value:function(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(me,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,onPageChanged:this.onPageChanged,users:this.props.users,follow:this.props.follow,unfollow:this.props.unfollow,toggleFollowingProgress:this.props.toggleFollowingProgress,followingInProgress:this.props.followingInProgress})})}}]),n}(z.a.Component),ve=Object(U.b)((function(e){return{users:e.usersPage.users,pageSize:e.usersPage.pageSize,totalUsersCount:e.usersPage.totalUsersCount,currentPage:e.usersPage.currentPage,isFetching:e.usersPage.isFetching,followingInProgress:e.usersPage.followingInProgress}}),{follow:function(e){return{type:x,userId:e}},unfollow:function(e){return{type:v,userId:e}},setUsers:function(e){return{type:w,users:e}},setCurrentPage:function(e){return{type:k,currentPage:e}},setTotalUsersCount:function(e){return{type:y,count:e}},toggleIsFetching:function(e){return{type:S,isFetching:e}},toggleFollowingProgress:function(e,t){return{type:N,isFetching:e,userId:t}}})(xe),we=n(37),ke=(n(86),function(){return Object(s.jsx)("div",{className:"wrapper",children:Object(s.jsxs)("div",{className:"lds-ellipsis",children:[Object(s.jsx)("div",{}),Object(s.jsx)("div",{}),Object(s.jsx)("div",{}),Object(s.jsx)("div",{})]})})}),ye=(n(87),Object(U.b)((function(e){return{token:e.auth.token}}),(function(e){return{login:function(t,n){e(C(t,n))}}}))((function(e){var t=e.login,n=Object(A.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[]),c=Y(),r=c.error,i=c.request,o=c.clearError,u=Object(A.useState)(!1),l=Object(q.a)(u,2),j=l[0],d=l[1],b=Object(A.useState)({email:"",displayName:"",password:""}),h=Object(q.a)(b,2),p=h[0],O=h[1],f=Object(A.useState)(!0),g=Object(q.a)(f,2),m=g[0],x=g[1];Object(A.useEffect)((function(){n(r),o()}),[r,n,o]),Object(A.useEffect)((function(){var e=JSON.parse(sessionStorage.getItem("storageName"));e&&e.token&&t(e.token,e.user)}),[t]);var v=function(e){O(Object(a.a)(Object(a.a)({},p),{},Object(we.a)({},e.target.name,e.target.value)))},w=function(){var t=Object(W.a)(J.a.mark((function t(){var s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,d(!0),t.next=4,i("/api/auth/register","POST",Object(a.a)({},p),{Authorization:"Bearer ".concat(e.token)});case 4:s=t.sent,n(s.message),d(!1),y(),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),alert(t.t0.message),d(!1);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),k=function(){var n=Object(W.a)(J.a.mark((function n(){var s;return J.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,d(!0),n.next=4,i("/api/auth/login","POST",Object(a.a)({},p),{Authorization:"Bearer ".concat(e.token)});case 4:s=n.sent,t(s.token,s.user),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),alert(n.t0.message),d(!1);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}(),y=function(){x(!m)};return Object(s.jsx)(s.Fragment,{children:j?Object(s.jsx)(ke,{}):Object(s.jsxs)("div",{className:"split-screen",children:[Object(s.jsx)("div",{className:"left",children:Object(s.jsxs)("section",{className:"copy",children:[Object(s.jsx)("h1",{children:"Kalina"}),Object(s.jsx)("p",{children:"For the beauty text."})]})}),Object(s.jsx)("div",{className:"right",children:Object(s.jsxs)("form",{children:[Object(s.jsxs)("section",{className:"copy",children:[Object(s.jsxs)("h2",{children:["Sign ",m?"up":"in"]}),Object(s.jsx)("div",{className:"login-container",children:m?Object(s.jsxs)("p",{children:["Already have an account? ",Object(s.jsx)("a",{onClick:y,children:Object(s.jsx)("strong",{children:"Sign in!"})})]}):Object(s.jsxs)("p",{children:["Don't have an account? ",Object(s.jsx)("a",{onClick:y,children:Object(s.jsx)("strong",{children:"Sign up!"})})]})})]}),m&&Object(s.jsxs)("div",{className:"input-container name",children:[Object(s.jsx)("label",{htmlFor:"displayName",children:"Nickname"}),Object(s.jsx)("input",{name:"displayName",id:"displayName",type:"text",value:p.displayName,onChange:v,required:!0})]}),Object(s.jsxs)("div",{className:"input-container email",children:[Object(s.jsx)("label",{htmlFor:"email",children:"Email"}),Object(s.jsx)("input",{name:"email",id:"email",type:"email",value:p.email,onChange:v,required:!0})]}),Object(s.jsxs)("div",{className:"input-container password",children:[Object(s.jsx)("label",{htmlFor:"password",children:"Password"}),Object(s.jsx)("input",{name:"password",id:"password",type:"password",value:p.password,onChange:v,placeholder:"At least 6 characters!",required:!0}),Object(s.jsx)("i",{className:"far fa-eye-slash"})]}),m?Object(s.jsx)("button",{className:"signup-btn",type:"submit",onClick:w,children:"Sign up"}):Object(s.jsx)("button",{className:"signup-btn",type:"submit",onClick:k,children:"Sign in"}),Object(s.jsx)("section",{className:"copy legal",children:Object(s.jsx)("p",{children:Object(s.jsxs)("span",{className:"small",children:["By continuing, you agree to accept our ",Object(s.jsx)("br",{}),Object(s.jsx)("a",{children:"Privacy Policy"})," & ",Object(s.jsx)("a",{children:"Terms of Service"}),"."]})})})]})})]})})}))),Se=(n(88),function(e){var t=e.imgWidth,n=e.imgHeight,c=[{url:"https://www.sunchemical.com/wp-content/uploads/2019/07/SunWave_banner-1200x400.jpg"},{url:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTPuUErrrIAbhJWNbw-taT2n5SqTHHPAdjPS6Nd8eGJhsYOmZ1sEHICT8QkN5EbEL0XWVo&usqp=CAU"},{url:"https://www.mapix.com/wp-content/uploads/2018/04/1200x400.png"},{url:"https://sinctech.com/wp-content/uploads/2017/07/placeholder-1200x400.png"}],r=Object(A.useRef)(null),a=Object(A.useRef)(null),i=Object(A.useRef)(null),o=Object(A.useRef)(null),u=Object(A.useRef)(c.map((function(){return Object(A.createRef)()}))),l=Object(A.useRef)(c.map((function(){return Object(A.createRef)()}))),j=1,d=0,b=1,h="";Object(A.useEffect)((function(){return h=x(window.getComputedStyle(r.current).width),g(),m(),window.addEventListener("resize",m),f(),a.current.style.width=100*c.length+"%",function(){return window.removeEventListener("resize",m)}}),[]);function p(){d==h*(c.length-1)?d=0:d+=h*b,console.log(d),a.current.style.transform="translateX(-".concat(d,"px)")}function O(){0===d?d=h*(c.length-1)*b:d-=h*b,console.log(d),a.current.style.transform="translateX(-".concat(d,"px)")}function f(){l.current.forEach((function(e){e.current.style.background="none"})),l.current[j-1].current.style.background="#fdc84b"}function g(){u.current.forEach((function(e){e.current.style.width="".concat(h,"px")}))}function m(){var e=h;h=x(window.getComputedStyle(r.current).width),g(),i.current.style.height="".concat(h/(t/n),"px"),h>e?d+=(j-1)*Math.abs(h-e):h<e&&(d-=(j-1)*Math.abs(h-e)),a.current.style.transform="translateX(-".concat(d,"px)")}function x(e){var t=e.length-e.split("").reverse().join("").search(/\d/);return Math.round(+e.split("").splice(0,t).join(""))}return Object(s.jsxs)("div",{className:"slider",ref:i,children:[Object(s.jsx)("div",{className:"container",ref:r,children:Object(s.jsx)("div",{className:"track",ref:a,children:c.map((function(e,t){var n=e.url;return Object(s.jsx)("div",{ref:u.current[t],className:"item",children:Object(s.jsx)("img",{src:n,alt:""})},t)}))})}),Object(s.jsx)("div",{className:"btn_prev",onClick:function(){O(),j>1?j--:j=c.length,f()}}),Object(s.jsx)("div",{className:"btn_next",onClick:function(){p(),j<c.length?j++:j=1,f()}}),Object(s.jsx)("div",{className:"dot-wrapper",ref:o,children:c.map((function(e,t){return Object(s.jsx)("div",{className:"slider-dot",ref:l.current[t],onClick:function(){return e=t+1,b=Math.abs(e-j),e<j?(j=e,O()):e>j&&(j=e,p()),b=1,void f();var e}},t)}))})]})}),Ne=(n(89),Object(U.b)((function(e){return{token:e.auth.token,user:e.auth.user}}))((function(e){var t=e.post,n=e.token,c=e.user,r=Y(),a=(r.loading,r.error,r.request),i=(r.clearError,Object(A.useState)(t.likes.includes(c._id))),o=Object(q.a)(i,2),u=o[0],l=o[1],j=Object(A.useState)(!1),d=Object(q.a)(j,2),b=d[0],h=d[1],p=Object(A.useState)(t.likes.length),O=Object(q.a)(p,2),f=O[0],g=O[1],m=Object(A.useState)(t.comments),x=Object(q.a)(m,2),v=x[0],w=x[1],k=Object(A.useState)(""),y=Object(q.a)(k,2),S=y[0],N=y[1];Object(A.useEffect)(Object(W.a)(J.a.mark((function e(){var s;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=5;break}return e.next=3,a("/api/posts/put/".concat(u?"like":"unlike"),"PUT",{postId:t._id},{Authorization:"Bearer ".concat(n)});case 3:s=e.sent,g(s.likes.length);case 5:case"end":return e.stop()}}),e)}))),[u]);var _=function(){var e=Object(W.a)(J.a.mark((function e(){var s;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a("/api/posts/put/comment","PUT",{postId:t._id,text:S},{Authorization:"Bearer ".concat(n)});case 2:s=e.sent,w(s.comments),N("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsx)("div",{className:"element",children:Object(s.jsxs)("div",{className:"card",children:[Object(s.jsx)("h5",{children:t.owner.displayName}),Object(s.jsx)("div",{className:"card-image",children:Object(s.jsx)("img",{src:t.picture,alt:""})}),Object(s.jsxs)("div",{className:"card-content",children:[Object(s.jsx)("i",{onClick:function(){h(!0),l(!u)},className:"material-icons",style:{fontSize:"40px",cursor:"pointer"},children:u?"favorite":"favorite_border"}),Object(s.jsxs)("h6",{children:[f," likes"]}),Object(s.jsx)("p",{children:t.body}),Object(s.jsx)("small",{children:Object(s.jsx)("strong",{children:"Comments"})}),v.map((function(e){return Object(s.jsx)("div",{children:e.owner.displayName+": "+e.text},e._id)})),Object(s.jsx)("input",{value:S,onChange:function(e){return N(e.target.value)},type:"text",placeholder:"add a comment"}),Object(s.jsx)("button",{onClick:_,children:"Send comment"})]})]})})}))),_e=Object(U.b)((function(e){return{token:e.auth.token}}))((function(e){var t=Object(A.useState)([]),n=Object(q.a)(t,2),c=n[0],r=n[1],a=Object(A.useState)(!0),i=Object(q.a)(a,2),o=i[0],u=i[1],l=Y(),j=(l.error,l.request);l.clearError;return Object(A.useEffect)(Object(W.a)(J.a.mark((function t(){var n;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j("/api/posts/get/posts","GET",null,{Authorization:"Bearer ".concat(e.token)});case 2:n=t.sent,r(n.posts),u(!1);case 5:case"end":return t.stop()}}),t)}))),[]),Object(s.jsxs)("div",{className:"home-page",children:[o&&Object(s.jsx)(ke,{}),Object(s.jsx)("div",{className:"element",children:Object(s.jsx)(Se,{imgWidth:1200,imgHeight:500})}),c.map((function(e){return Object(s.jsx)(Ne,{post:e},e._id)}))]})})),Ee=Object(U.b)((function(e){return{token:e.auth.token}}),(function(e){return{login:function(t,n){e(C(t,n))}}}))((function(e){var t=JSON.parse(sessionStorage.getItem("storageName")),n=Object(A.useRef)(null),c=!!e.token,r=Object(s.jsxs)(M.c,{children:[Object(s.jsx)(M.a,{path:"/dialogs",component:je}),Object(s.jsx)(M.a,{exact:!0,path:"/profile",render:function(){return Object(s.jsx)(de,{})}}),Object(s.jsx)(M.a,{exact:!0,path:"/users",render:function(){return Object(s.jsx)(ve,{})}}),Object(s.jsx)(M.a,{exact:!0,path:"/",component:_e})]});function a(){try{n.current.style.height=document.body.clientHeight-(c?40:0)+"px"}catch(e){}}return t&&t.token&&e.login(t.token,t.user),Object(A.useEffect)((function(){return a(),window.addEventListener("resize",a),function(){return window.removeEventListener("resize",a)}}),[c]),Object(s.jsx)(G.a,{children:c?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"white-line"}),Object(s.jsxs)("div",{className:"app",children:[Object(s.jsx)(R,{}),Object(s.jsx)("div",{ref:n,className:"app-wrapper",children:r})]})]}):Object(s.jsx)(M.a,{path:"/",exact:!0,component:ye})})})),Pe=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(Pe,"px")),window.addEventListener("resize",(function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))})),F.a.render(Object(s.jsx)(U.a,{store:D,children:Object(s.jsx)(Ee,{})}),document.getElementById("root"))}},[[90,1,2]]]);
//# sourceMappingURL=main.d5265f6c.chunk.js.map